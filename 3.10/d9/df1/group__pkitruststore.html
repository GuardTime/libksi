<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Guardtime KSI c SDK: PKI Truststore</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Guardtime KSI c SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">PKI Truststore</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae4d98ab7b806a6a2fbcd3b3b28060178"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gae4d98ab7b806a6a2fbcd3b3b28060178">KSI_PKITruststore_registerGlobals</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx)</td></tr>
<tr class="separator:gae4d98ab7b806a6a2fbcd3b3b28060178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e3a1eaacfbec7212cff20fb492fa6cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga8e3a1eaacfbec7212cff20fb492fa6cc">KSI_PKITruststore_new</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx, int setDefaults, <a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> **store)</td></tr>
<tr class="separator:ga8e3a1eaacfbec7212cff20fb492fa6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab693726c736aaabc7a979d916f285b9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gab693726c736aaabc7a979d916f285b9c">KSI_PKITruststore_free</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *store)</td></tr>
<tr class="separator:gab693726c736aaabc7a979d916f285b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf52a451613c3dbf9bdf010faf64a40d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gaaf52a451613c3dbf9bdf010faf64a40d">KSI_PKICertificate_new</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx, const void *der, size_t der_len, <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> **cert)</td></tr>
<tr class="separator:gaaf52a451613c3dbf9bdf010faf64a40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24c9853a85586e51a5add8fa6dbb9d81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga24c9853a85586e51a5add8fa6dbb9d81">KSI_PKICertificate_free</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *cert)</td></tr>
<tr class="separator:ga24c9853a85586e51a5add8fa6dbb9d81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c6dbde499b93a11a8ab12db89212aad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga0c6dbde499b93a11a8ab12db89212aad">KSI_PKICertificate_fromTlv</a> (<a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> *tlv, <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> **o)</td></tr>
<tr class="separator:ga0c6dbde499b93a11a8ab12db89212aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf27162afa5f70a36ad747b6ce3dd5407"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gaf27162afa5f70a36ad747b6ce3dd5407">KSI_PKICertificate_toTlv</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx, <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *o, unsigned tag, int isNonCritical, int isForward, <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> **tlv)</td></tr>
<tr class="separator:gaf27162afa5f70a36ad747b6ce3dd5407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacbb2b0cb28ac363412bf345d52c496e0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gacbb2b0cb28ac363412bf345d52c496e0">KSI_PKICertificate_serialize</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *cert, unsigned char **raw, size_t *raw_len)</td></tr>
<tr class="separator:gacbb2b0cb28ac363412bf345d52c496e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa276380b3b01f0151e2e8587ad8c570"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gafa276380b3b01f0151e2e8587ad8c570">KSI_PKISignature_new</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx, const void *raw, size_t raw_len, <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> **signature)</td></tr>
<tr class="separator:gafa276380b3b01f0151e2e8587ad8c570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c6df76d4960b7c605586e98973334d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga3c6df76d4960b7c605586e98973334d0">KSI_PKISignature_free</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *sig)</td></tr>
<tr class="separator:ga3c6df76d4960b7c605586e98973334d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9437af0586ded3e389d95e247a50b4da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga9437af0586ded3e389d95e247a50b4da">KSI_PKISignature_extractCertificate</a> (const <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *signature, <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> **cert)</td></tr>
<tr class="separator:ga9437af0586ded3e389d95e247a50b4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffb21737922c53fc46f3c79ff530f23a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gaffb21737922c53fc46f3c79ff530f23a">KSI_PKISignature_serialize</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *sig, unsigned char **raw, size_t *raw_len)</td></tr>
<tr class="separator:gaffb21737922c53fc46f3c79ff530f23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga17d9c08813de29f616be7ca23bb93a21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga17d9c08813de29f616be7ca23bb93a21">KSI_PKISignature_fromTlv</a> (<a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> *tlv, <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> **o)</td></tr>
<tr class="separator:ga17d9c08813de29f616be7ca23bb93a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f32b0ca693e36f4ec9772df1754a4a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga6f32b0ca693e36f4ec9772df1754a4a7">KSI_PKISignature_toTlv</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx, <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *o, unsigned tag, int isNonCritical, int isForward, <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> **tlv)</td></tr>
<tr class="separator:ga6f32b0ca693e36f4ec9772df1754a4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab94a00cc95a375f257b71133266a66bb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gab94a00cc95a375f257b71133266a66bb">KSI_PKITruststore_verifyRawSignature</a> (<a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *ctx, const unsigned char *data, size_t data_len, const char *algoOid, const unsigned char *signature, size_t signature_len, const <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *cert)</td></tr>
<tr class="separator:gab94a00cc95a375f257b71133266a66bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga766bc29ad2eb5b2afa021901e21c8b65"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga766bc29ad2eb5b2afa021901e21c8b65">KSI_FN_DEPRECATED</a> (int KSI_PKITruststore_verifySignature(<a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *pki, const unsigned char *data, size_t data_len, const <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *signature))</td></tr>
<tr class="separator:ga766bc29ad2eb5b2afa021901e21c8b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61890a64d985557214c221d7f9bc47f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga61890a64d985557214c221d7f9bc47f8">KSI_PKITruststore_verifyPKISignature</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *pki, const unsigned char *data, size_t data_len, const <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *signature, <a class="el" href="../../df/d8a/group__ksi__types.html#gaf07ece106918f33b58800f4ee08cd157">KSI_CertConstraint</a> *certConstraints)</td></tr>
<tr class="separator:ga61890a64d985557214c221d7f9bc47f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c48c49eb56be5f1bf03cea8c03ae65a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#ga2c48c49eb56be5f1bf03cea8c03ae65a">KSI_PKITruststore_addLookupFile</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *store, const char *path)</td></tr>
<tr class="separator:ga2c48c49eb56be5f1bf03cea8c03ae65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3edb71c0ef80e1a72af839b88bfcb4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gaf3edb71c0ef80e1a72af839b88bfcb4e">KSI_PKITruststore_addLookupDir</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *store, const char *path)</td></tr>
<tr class="separator:gaf3edb71c0ef80e1a72af839b88bfcb4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8bf6a30527603d2aca795b18e3aec54"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/df1/group__pkitruststore.html#gad8bf6a30527603d2aca795b18e3aec54">KSI_PKICertificate_toString</a> (<a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *cert, char *buf, size_t buf_len)</td></tr>
<tr class="separator:gad8bf6a30527603d2aca795b18e3aec54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module is used for PKI operations.</p>
<p>The main components are: 1) <a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> - contains and verifies certificates. 2) <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> - an implementation independent PKI certificate object. 3) <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> - an implementation independent PKI signature object. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga766bc29ad2eb5b2afa021901e21c8b65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KSI_FN_DEPRECATED </td>
          <td>(</td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>KSI_PKITruststore_verifySignature</em>KSI_PKITruststore *pki, const unsigned char *data, size_t data_len, const KSI_PKISignature *signature</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function for verifying the data with PKI Signature. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pki</td><td>PKI Truststore. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to signed data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_len</td><td>Length of the signed data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>PKI signature object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code><a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a></code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga24c9853a85586e51a5add8fa6dbb9d81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KSI_PKICertificate_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor for the PKI Certificate object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>PKI Certificate object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga0c6dbde499b93a11a8ab12db89212aad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKICertificate_fromTlv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> *&#160;</td>
          <td class="paramname"><em>tlv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> **&#160;</td>
          <td class="paramname"><em>o</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to convert a plain <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> to a <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> . The TLV meta data (i.e. tag, length and flags) are not preserved. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tlv</td><td>Pointer to <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o</td><td>Pointer to receiving pointer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d9/df1/group__pkitruststore.html#ga0c6dbde499b93a11a8ab12db89212aad">KSI_PKICertificate_fromTlv</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaaf52a451613c3dbf9bdf010faf64a40d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKICertificate_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>der</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>der_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> **&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PKI Certificate constructor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">der</td><td>Pointer to DER encoded certificate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">der_len</td><td>Length of the certificate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cert</td><td>Pointer to the receiving pointer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="gacbb2b0cb28ac363412bf345d52c496e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKICertificate_serialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>raw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>raw_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to serialise the KSI Certificate object as DER. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>PKI Certificate object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">raw</td><td>Pointer to the receiving pointer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">raw_len</td><td>Serialized length. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gad8bf6a30527603d2aca795b18e3aec54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* KSI_PKICertificate_toString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a string representation of a PKI Certificate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>input certificate object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to the receiving buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_len</td><td>length of the receiving buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>buf if successful, NULL otherwise; </dd></dl>

</div>
</div>
<a class="anchor" id="gaf27162afa5f70a36ad747b6ce3dd5407"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKICertificate_toTlv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isNonCritical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isForward</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> **&#160;</td>
          <td class="paramname"><em>tlv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to convert a <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> to a plain <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o</td><td>Pointer to <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>Tag value of the <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isNonCritical</td><td>Flag is-non-critical. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isForward</td><td>Flag is-forward. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tlv</td><td>Pointer to the receiving pointer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d9/df1/group__pkitruststore.html#ga0c6dbde499b93a11a8ab12db89212aad">KSI_PKICertificate_fromTlv</a>, <a class="el" href="../../dc/d88/group__tlv.html#gaafd551b913d97304640bc726272fb516">KSI_TLV_free</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga9437af0586ded3e389d95e247a50b4da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKISignature_extractCertificate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> **&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extracts a PKI certificate from PKI signature. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>PKI Signature object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cert</td><td>Pointer to the receiving pointer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga3c6df76d4960b7c605586e98973334d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KSI_PKISignature_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor for the PKI Signature object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>PKI Signature object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga17d9c08813de29f616be7ca23bb93a21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKISignature_fromTlv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> *&#160;</td>
          <td class="paramname"><em>tlv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> **&#160;</td>
          <td class="paramname"><em>o</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to convert a plain <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> to a <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> . The TLV meta data (i.e. tag, length and flags) are not preserved. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tlv</td><td>Pointer to <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">o</td><td>Pointer to receiving pointer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d9/df1/group__pkitruststore.html#ga17d9c08813de29f616be7ca23bb93a21">KSI_PKISignature_fromTlv</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gafa276380b3b01f0151e2e8587ad8c570"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKISignature_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>raw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>raw_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> **&#160;</td>
          <td class="paramname"><em>signature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor for PKI Signature object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw</td><td>PKCS7 encoded signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_len</td><td>Signature len. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">signature</td><td>Pointer to the receiving pointer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="gaffb21737922c53fc46f3c79ff530f23a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKISignature_serialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>raw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>raw_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Serializes the <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>Pointer to the PKI signature. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">raw</td><td>Pointer to the receiving pointer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">raw_len</td><td>Serialized value length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga6f32b0ca693e36f4ec9772df1754a4a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKISignature_toTlv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isNonCritical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isForward</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> **&#160;</td>
          <td class="paramname"><em>tlv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to convert a <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> to a plain <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o</td><td>Pointer to <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>Tag value of the <a class="el" href="../../de/dea/group__base__types.html#ga1861ac1d881ea649c5775e8626c09f69">KSI_TLV</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isNonCritical</td><td>Flag is-non-critical. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isForward</td><td>Flag is-forward. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tlv</td><td>Pointer to the receiving pointer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d9/df1/group__pkitruststore.html#ga17d9c08813de29f616be7ca23bb93a21">KSI_PKISignature_fromTlv</a>, <a class="el" href="../../dc/d88/group__tlv.html#gaafd551b913d97304640bc726272fb516">KSI_TLV_free</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaf3edb71c0ef80e1a72af839b88bfcb4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKITruststore_addLookupDir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add trusted certificate lookup directory. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">store</td><td>PKI truststore. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Null-terminated sting path to the directory containing trusted certificates..</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code><a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a></code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga2c48c49eb56be5f1bf03cea8c03ae65a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKITruststore_addLookupFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add trusted certificate lookup file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">store</td><td>PKI truststore. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Null-terminated sting path to the file containing trusted certificates.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code><a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a></code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="gab693726c736aaabc7a979d916f285b9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KSI_PKITruststore_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *&#160;</td>
          <td class="paramname"><em>store</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor for the PKI Truststore object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">store</td><td>PKI Truststore object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga8e3a1eaacfbec7212cff20fb492fa6cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKITruststore_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>setDefaults</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> **&#160;</td>
          <td class="paramname"><em>store</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PKI Truststore constructor. If <code><code>setDefaults</code> == 1</code>, the truststore is initiated with default settings, otherwise a blank truststore is created. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">setDefaults</td><td>With or without default system settings. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">store</td><td>Pointer to the receiving pointer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="gae4d98ab7b806a6a2fbcd3b3b28060178"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKITruststore_registerGlobals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is used to register the init and cleanup functions of the truststore. The init function is called once per KSI context and the cleanup function is called once when the KSI context is freed with <a class="el" href="../../dd/df2/group__base.html#ga40d9e85aa8b1bd9218e8395e5a79838a">KSI_CTX_free</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga61890a64d985557214c221d7f9bc47f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKITruststore_verifyPKISignature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#gac49dcb7ce19c3ca4db7745333dd7e757">KSI_PKITruststore</a> *&#160;</td>
          <td class="paramname"><em>pki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d8a/group__ksi__types.html#ga827e2f0230fb4df1af34ee5f00d65357">KSI_PKISignature</a> *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d8a/group__ksi__types.html#gaf07ece106918f33b58800f4ee08cd157">KSI_CertConstraint</a> *&#160;</td>
          <td class="paramname"><em>certConstraints</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function for verifying the data with PKI Signature. Explicitly verifies against publications file constraints specified in <code>certConstraints</code>. If NULL is passed as <code>certConstraints</code>, verification is performed implicitly against context based constraints. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pki</td><td>PKI Truststore. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to signed data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_len</td><td>Length of the signed data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>PKI signature object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">certConstraints</td><td>PKI certificate constraints.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code><a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a></code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="gab94a00cc95a375f257b71133266a66bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_PKITruststore_verifyRawSignature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dea/group__base__types.html#ga4a5d4eaf93fb3a8f039c4853b912dc2d">KSI_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>algoOid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signature_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d8a/group__ksi__types.html#ga43fb3ffeb895f43d7d8ce5ed26442a0b">KSI_PKICertificate</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function for verifying a raw PKCS#1 signature. TODO! - explain in detail! </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>KSI context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to input data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_len</td><td>Input data len. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algoOid</td><td>Algorithm OID used to sign the input data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>Pointer to the raw PKCS#1 signature. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_len</td><td>Signature length. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>PKI Certificate object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code><a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a></code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
